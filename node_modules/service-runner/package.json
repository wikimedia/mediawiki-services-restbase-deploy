{
  "name": "service-runner",
  "version": "0.1.2",
  "description": "Generic nodejs service supervisor / cluster runner",
  "main": "service-runner.js",
  "bin": {
    "service-runner": "./service-runner.js"
  },
  "scripts": {
    "start": "./service-runner.js",
    "test": "mocha",
    "coverage": "sh test/utils/cleandb.sh && istanbul cover _mocha -- -R spec",
    "coveralls": "cat ./coverage/lcov.info | coveralls"
  },
  "repository": {
    "type": "git",
    "url": "git://github.com/wikimedia/service-runner.git"
  },
  "keywords": [
    "supervisor",
    "cluster",
    "logging",
    "statsd"
  ],
  "author": {
    "name": "Wikimedia service team",
    "email": "services@wikimedia.org"
  },
  "license": "Apache2",
  "bugs": {
    "url": "https://github.com/wikimedia/service-runner/issues"
  },
  "homepage": "https://github.com/wikimedia/service-runner",
  "dependencies": {
    "bluebird": "~2.2.2",
    "bunyan": "^1.3.3",
    "core-js": "^0.5.4",
    "extend": "^1.3.0",
    "gelf-stream": "^0.2.4",
    "heapdump": "^0.3.3",
    "js-yaml": "~3.2.2",
    "node-statsd": "^0.1.1",
    "node-txstatsd": "^0.1.5",
    "yargs": "~1.3.0"
  },
  "devDependencies": {
    "mocha": "~1.x.x",
    "mocha-jshint": "0.0.9",
    "istanbul": "0.3.5",
    "mocha-lcov-reporter": "0.0.1",
    "coveralls": "2.11.2"
  },
  "readme": "# service-runner\nGeneric nodejs service runner & supervisor\n\n## Goals\n- Supervise and cluster node services in a generic manner with a minimal interface:\n\n```javascript\nmodule.exports = function (options) {\n    var config = options.config;\n    // Logger instance\n    var logger = options.logger;\n    // Statsd metrics reporter\n    var statsd = options.statsd;\n\n    // Start the app, returning a promise\n    return startApp(config, logger, statsd);\n}\n```\n\n- standard command line parameters:\n```bash\nUsage: node ./service-runner.js [-h|-v] [--param[=val]]\n\nOptions:\n  -n, --num-workers  [default: -1]\n  -c, --config       [default: \"./config.yaml\"]\n  -v, --version      [default: false]\n  -h, --help         [default: false]\n```\n- [config loading](#config-loading)\n- flexible logging using bunyan, including logstash support via gelf\n- metric reporting using txstatsd\n- heap dumps\n\n## Usage\n```bash\nnpm install --save service-runner\n```\n\nIn package.json, configure `npm start` to call service-runner:\n```javascript\n  \"scripts\": {\n    \"start\": \"service-runner\"\n  }\n```\nCreate a `config.yaml` file following the spec below. Make sure to point the\nmodule parameter to your service's entry point.\n\nFinally, **start your service with `npm start`**. In npm >= 2.0 (node 0.12 or iojs), you can also pass parameters to `service-runner` like this: `npm start -- -c /etc/yourservice/config.yaml`.\n\nFor node 0.10 support, you can create a small wrapper script like this:\n```javascript\nvar ServiceRunner = require('service-runner');\nnew ServiceRunner().run();\n```\n\nWe are also working on a [standard\ntemplate](https://github.com/wikimedia/service-template-node) for node\nservices, which will set up this & other things for you.\n\n### Config loading\n- Default config locations in a project: `config.yaml` for a customized config,\n    and `config.example.yaml` for the defaults.\n- Default top-level config format (**draft**):\n\n```yaml\n# Info about this config. Used for packaging & other purposes.\ninfo: \n  name: parsoid\n  version: 0.4.0\n  description: Bidirectional conversion service between MediaWiki wikitext and\n        HTML5\n\n# Package settings. Modeled on Debian, but likely to transfer to rpm as well.\npackaging:\n  depends:\n    nodejs: >=0.10.0\n  enhances: mediawiki\n\n\n# Number of worker processes to spawn. \n# Set to 0 to run everything in a single process without clustering.\nnum_workers: 1\n\n# Logger info\nlogging:\n  level: info\n  streams:\n  # Use gelf-stream -> logstash\n  - type: gelf\n    host: logstash1003.eqiad.wmnet\n    port: 12201\n\n# Statsd metrics reporter\nmetrics:\n  type: txstatsd\n  host: localhost\n  port: 8125\n\nservices:\n  - name: parsoid\n    # a relative path or the name of an npm package, if different from name\n    # module: ./lib/server.js\n\n    # optionally, a version constraint of the npm package\n    # version: ^0.4.0\n    \n    # per-service config\n    conf:\n        port: 12345\n        interface: localhost\n        # more per-service config settings\n```\n\n# Issue tracking\n\nPlease report issues in [the service-runner phabricator\nproject](https://phabricator.wikimedia.org/tag/service-runner/).\n\n# See also\n- https://github.com/Unitech/PM2/ - A lot of features. Focus on interactive\n    use with commandline tools. Weak on logging (only local log files). Does\n    not support node 0.10's cluster module.\n- https://github.com/strongloop/strong-agent - commercial license. Focus on\n    profiling and monitoring, although a lot of the functionality is now\n    available in other libraries.\n- http://krakenjs.com/ - Focused more on MVC & templating rather than\n    supervision & modules\n",
  "readmeFilename": "README.md",
  "gitHead": "cc47d99d34020262973763914c413adf768e022f",
  "_id": "service-runner@0.1.2",
  "_shasum": "32bba0aa1710dd5eb99034268b4fb6c0bba0966c",
  "_from": "service-runner@^0.1.0"
}
